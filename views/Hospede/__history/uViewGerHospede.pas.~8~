unit uViewGerHospede;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Vcl.Grids, Vcl.DBGrids,
  Vcl.StdCtrls, Vcl.Mask, FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Param, FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf,
  FireDAC.DApt.Intf, FireDAC.Stan.Async, FireDAC.DApt, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, Datasnap.DBClient;

type
  TfrmGerHospede = class(TForm)
    txtEditNome: TEdit;
    txtEditIdade: TEdit;
    IdadeEdit: TLabel;
    txtEditProfissao: TEdit;
    ProfissaoEdit: TLabel;
    txtEditNacionalidade: TEdit;
    nacionalidadeEdit: TLabel;
    comEditSexo: TComboBox;
    SexoEdit: TLabel;
    txtEditCep: TMaskEdit;
    CEPEdit: TLabel;
    txtEditFone: TMaskEdit;
    FoneEdit: TLabel;
    txtEditCpf: TMaskEdit;
    CPFEdit: TLabel;
    NomeEdit: TLabel;
    btnDeletar: TButton;
    btnAlterar: TButton;
    btnPesquisar: TButton;
    txtPesquisa: TMaskEdit;
    GerenciamentoHospede: TLabel;
    comPesquisa: TComboBox;
    Label4: TLabel;
    tbhospede: TDBGrid;
    cdshospede: TClientDataSet;
    Tb_hospedeTable: TFDQuery;
    dshospede: TDataSource;
    procedure tbhospedeCellClick(Column: TColumn);
    procedure btnAlterarClick(Sender: TObject);
    procedure btnPesquisarClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmGerHospede: TfrmGerHospede;

implementation

{$R *.dfm}

uses uHospedeDao;

procedure TfrmGerHospede.btnAlterarClick(Sender: TObject);
begin
  HospedeDao:=THospedeDAO.Create(Self);
try
  HospedeDao.alterarHospede(txtEditNome.Text,txtEditCpf.Text,comEditSexo.Text,txtEditProfissao.Text,StrtoInt(txtEditIdade.Text),txtEditCep.Text,txtEditFone.Text,txtEditNacionalidade.Text,tbhospede.Fields[0].Value)  ;
  tbhospede.DataSource.DataSet.Refresh;
  except on E:Exception do
begin
  ShowMessage(E.Message);
end;
  end;
  HospedeDao.Free;
end;

procedure TfrmGerHospede.btnPesquisarClick(Sender: TObject);
begin
    HospedeDao:=THospedeDAO.Create(Self);
if comPesquisa.Text='Nome' then
begin
with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'nome LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end

else if comPesquisa.Text='CPF' then
begin


  with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'cpf LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
else if comPesquisa.Text='CEP' then
begin
  with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'cep LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
else if comPesquisa.Text='Idade' then
begin
   with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'idade LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
else if comPesquisa.Text='Nacionalidade' then
begin
   with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'nacionalidade LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
else if comPesquisa.Text='Fone' then
begin
   with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'fone LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
else if comPesquisa.Text='Sexo' then
begin
   with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'sexo LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end
 else if comPesquisa.Text='Profissão' then
begin
   with Tb_hospedeTable do
begin
       close;
  sql.Clear;
  sql.Add('SELECT * FROM tb_hospede WHERE '+'profissao LIKE ''%'+txtPesquisa.Text+'%''');
  Open
end;
end;
   tbhospede.DataSource.DataSet.Refresh;

end;

procedure TfrmGerHospede.tbhospedeCellClick(Column: TColumn);
begin
   txtEditNome.Text          := tbhospede.Fields[1].Value;
   txtEditCpf.Text           := tbhospede.Fields[2].Value;
   txtEditFone.Text          := tbhospede.Fields[7].Value;
   txtEditCep.Text           := tbhospede.Fields[6].Value;
   comEditSexo.Text          := tbhospede.Fields[3].Value;
   txtEditNacionalidade.Text := tbhospede.Fields[8].Value;
   txtEditProfissao.Text     := tbhospede.Fields[4].Value;
   txtEditIdade.Text         := tbhospede.Fields[5].Value;
end;

end.
